<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>S T A R B L O O D</title>
    <style>
        :root {
            --blood-dark: #8a0000;
            --blood-glow: #ff3333;
            --card-h: clamp(80px, 16dvh, 150px);
            --card-w: calc(var(--card-h) * 0.7);
            --gap: clamp(6px, 1.2dvh, 12px);
        }

        body {
            background:#000; color:white;
            font-family:'Courier New', monospace;
            height: 100dvh; width:100vw;
            overflow:hidden; touch-action:none;
            display: flex; flex-direction: column;
        }

        #game-board {
            flex: 1;
            display:grid; 
            grid-template-columns:repeat(4, 1fr);
            gap:var(--gap);
            padding: 10px;
            justify-items: center;
            align-content: center;
            z-index: 500;
        }

        /* --- THE SLIDER CARD --- */
        .card {
            width: var(--card-w);
            height: var(--card-h);
            position: relative;
            overflow: hidden; /* Clips the slider track */
            border-radius: 8px;
            border: 1px solid var(--blood-dark);
            background: #000;
        }

        .slider-track {
            display: flex;
            width: 200%; /* Two panels side-by-side */
            height: 100%;
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            will-change: transform;
        }

        /* Slide state */
        .card.active .slider-track {
            transform: translateX(-50%);
        }

        .panel {
            width: 50%;
            height: 100%;
            position: relative;
        }

        .video-panel video {
            width: 100%; height: 100%; object-fit: cover;
            opacity: 0.8;
        }

        .image-panel {
            background-size: cover;
            background-position: center;
            box-shadow: inset 0 0 20px #000;
        }

        /* --- SMOKE / MATCH EFFECT --- */
        @keyframes smokeTransfer {
            0% { transform: scale(1); filter: blur(0px) grayscale(0); opacity: 1; }
            50% { transform: scale(1.1) translateY(-20px); filter: blur(10px) grayscale(1); opacity: 0.5; }
            100% { transform: scale(0) translate(var(--tx), var(--ty)); filter: blur(20px); opacity: 0; }
        }

        .smoke-out {
            animation: smokeTransfer 1s forwards;
            pointer-events: none;
        }

        /* UI Styles */
        #deck-frame {
            position:fixed; bottom:15px; right:15px; 
            width:56px; height:80px;
            border:1px solid var(--blood-glow); border-radius:8px;
            background: rgba(20,0,0,0.5);
        }

        #landing {
            position:fixed; inset:0; z-index:2000; background:#000;
            display:flex; align-items:center; justify-content:center;
        }
    </style>
</head>
<body>

<div id="landing">
    <button style="padding:20px; color:red; border:1px solid red; background:none;" onclick="start()">INITIATE SLIDE</button>
</div>

<div id="deck-frame"></div>
<div id="game-board"></div>

<script>
const faceFiles = [
    "./api/asset/Screenshot_2026-01-20-15-02-24-76.jpg",
    "./api/asset/Screenshot_2026-01-20-15-05-56-58.jpg",
    "./api/asset/Screenshot_2026-01-20-15-06-24-65.jpg",
    "./api/asset/Screenshot_2026-01-20-15-06-39-34.jpg"
]; // Add all 10 here

let selected = [];
let locked = false;

function start() {
    document.getElementById('landing').style.display = 'none';
    buildBoard();
}

function buildBoard() {
    const board = document.getElementById('game-board');
    let deck = [...faceFiles, ...faceFiles].sort(() => Math.random() - 0.5);

    deck.forEach(img => {
        const card = document.createElement('div');
        card.className = 'card';
        card.dataset.val = img;

        card.innerHTML = `
            <div class="slider-track">
                <div class="panel video-panel">
                    <video autoplay muted loop playsinline>
                        <source src="./bg/Videoleap_2026_01_20_18_07_56_976.mp4" type="video/mp4">
                    </video>
                </div>
                <div class="panel image-panel" style="background-image:url('${img}')"></div>
            </div>
        `;

        card.addEventListener('pointerdown', () => {
            if (locked || selected.length >= 2 || card.classList.contains('active')) return;
            
            card.classList.add('active'); // Slide the video over
            selected.push(card);

            if (selected.length === 2) {
                locked = true;
                setTimeout(checkMatch, 800);
            }
        });

        board.appendChild(card);
    });
}

function checkMatch() {
    const [a, b] = selected;
    if (a.dataset.val === b.dataset.val) {
        // Calculate distance to deck for smoke effect
        const deck = document.getElementById('deck-frame').getBoundingClientRect();
        [a, b].forEach(card => {
            const rect = card.getBoundingClientRect();
            const tx = (deck.left - rect.left) + "px";
            const ty = (deck.top - rect.top) + "px";
            card.style.setProperty('--tx', tx);
            card.style.setProperty('--ty', ty);
            card.classList.add('smoke-out');
        });
        selected = [];
        locked = false;
    } else {
        // No match: Resume video function by sliding back
        setTimeout(() => {
            a.classList.remove('active');
            b.classList.remove('active');
            selected = [];
            locked = false;
        }, 1000);
    }
}
</script>
</body>
</html>
